<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <!--라이브러리-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.8/c3.css">

  <!--커스텀-->
  <link rel="stylesheet" href="./c3-custom.css">
</head>
<body>
<h1>Date Chart</h1>
<div id="chart-date"></div>
<img src="./goal.png">

<!--라이브러리-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.0.0/d3.js" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.8/c3.js"></script>
<!--커스텀-->
<script src="./config.js"></script>
<script src="./chart-adaptor.js"></script>
<script>
  window.onload = () => {
    const element = document.querySelector('#chart-date')
    const labels = [
      '2010-01-01',
      '2011-01-01',
      '2012-01-01',
      '2013-01-01',
      '2014-01-01',
      '2015-01-01',
      '2016-01-01',
      '2017-01-01'
    ]
    const columns = Array
      .from({length: 10}, (v, index) => index + 1)
      .map(index => {
        return [`data${index}`]
          .concat([110, 90, 110, 90, 110, 90, 110, 90].map(v => v * index))
      })

    const chart = mountChart({
      element,
      labels,
      columns,
      xAxisFormat: (x) => {
        return x.getFullYear()
      },
      tooltipTitleFormat: (x) => {
        const year = x.getFullYear()
        const month = x.getMonth() + 1
        return `${year}.${month > 10 ? month : '0' + month}`
      },
      tooltipValueFormat: value => `${value}%`,
    })

    setTimeout(() => {
      const copiedLabels = [...labels]
      const copiedColumns = [...columns]

      copiedColumns.forEach(items => {
        items.length = items.length - 1
      })
      copiedLabels.length = copiedLabels.length - 1

      changeData({
        chart,
        labels: copiedLabels,
        columns: copiedColumns,
      })
    }, 5000)
  }
</script>
</body>
</html>